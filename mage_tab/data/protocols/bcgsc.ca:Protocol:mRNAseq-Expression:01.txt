Gene Coverage Analysis
Protocol Name: bcgsc.ca:RNA_Sequencing:IlluminaGA_RNASeq:01
Link:www.bcgsc.ca/downloads/genomes/Homo_sapiens/hg19/1000genomes/bwa_ind/genome/
Data Level: 3
Data File: *.gene.quantification.txt

The gene coverage analysis was performed with our internal analysis pipeline version 1.1 using "composite" gene annotations from the hg19 (GRCh37-lite) version of the TCGA GAF v3.0. These composite gene models were created in June 2011 by UNC (with assistance from UCSC) based on the annotations in the "UCSC genes" database. Each composite gene annotation was generated by collapsing all transcripts of that gene into a single model such that exonic bases in a composite gene model were the union of exonic bases from all known transcripts of the gene. Thus, the locations of the exonic boundaries used for the gene coverage analysis were not based on a single canonical transcript for each gene. Consequently, the exonic boundaries in a composite gene model may not correspond to the actual boundaries of the expressed transcripts.

For simplicity, throughout this document and in the gene coverage results files, a composite gene model is simply referred to as a gene, and it is associated with the id of the gene whose transcripts contributed to that composite model.

To generate the raw read counts, we first counted the number of bases of each read that were inside exonic regions in a gene, and then divided this total base count by the read length. Thus our values for the raw number of reads were not whole numbers (i.e. if the entire 50bp read mapped to an exon, we would add 50 to the total base count, which would ultimately contribute 1 to the raw read count. However, if only 25 bases of the read's alignment fell within an exon's boundaries, the total base count would be incremented by 25, which would ultimately contribute 0.5 to the raw read count).

In order to comply with the file format specification enforced by the DCC validator, our raw read counts are rounded to the closest whole number.

A gene's raw read count is the sum of raw read counts for exons belonging to the gene.
Gene coverage is its raw read count divided by the sum of its exon lengths.
RPKM is calculated using the formula:
(number of reads mapped to all exons in a gene x 1,000,000,000)/(NORM_TOTAL x sum of the lengths of all exons in the gene )
[Note: NORM_TOTAL = the total number of reads that are mapped to all exons from the composite gene models. (i.e. sum of the fractional read count for all exons)]

If a read alignment contained a deletion or a large gap, the read did not contribute coverage inside the region spanned by the deletion/gap. Each of the paired end reads was counted separately. We excluded reads from pairs that failed Illumina's Chastity filter, as well as reads with mapping quality < 10.

.gene.quantification.txt
A tab-delimited text file containing the following fields:
- gene = Gene ID from GAF (version 3.0).  The ID follows the nomenclature '<HUGO gene symbol>|<Entrez ID>'.  If the combination of the HUGO symbol and the Entrez ID is not unique, an additional 'NofM' descriptor is added.  An ID with '?' indicates that the HUGO gene symbol or Entrez ID is not available.  e.g. U80769|?; TRNA_Pseudo|?|8of100
- raw_counts = Sum of fraction of reads (rounded off to nearest integer - restricted by the RNA-seq validator) that mapped to collapsed transcripts representing a specific gene.  Reads from pairs that did not pass Illumina’s Chastity filter or with mapping quality less than 10, i.e. reads that did not map uniquely, were excluded from calculation.
- median_length_normalized = Average coverage over all exons in the collapsed transcripts i.e. sum of the coverage depth at each base in all exons divided by the sum of the exon lengths
- RPKM = Reads per kilobase of exon per million.  Calculation described in detail below.

Exon Coverage Analysis
Protocol Name: bcgsc.ca:RNA_Sequencing:IlluminaGA_RNASeq:01
Link:www.bcgsc.ca/downloads/genomes/Homo_sapiens/hg19/1000genomes/bwa_ind/genome/
Data Level: 3
Data File: *.exon.quantification.txt

The exon coverage analysis was performed with our internal analysis pipeline version 1.1 using "composite" gene annotations from the hg19 (GRCh37-lite) version of the TCGA GAF v3.0.  These composite gene models were created in June 2011 by UNC (with assistance from UCSC) based on the annotations in the "UCSC genes" database.
Similarly to the gene coverage analysis, all transcripts of a given gene were collapsed into a single model such that exonic bases in a composite gene model were the union of exonic bases from all known transcripts of the gene.  For simplicity, throughout this document and in the exon coverage results files, the collapsed exons are simply referred to as an exon.

To generate the raw read counts, we first counted the number of bases of each read that were inside an exonic region, and then divided this total base count by the read length. Thus our values for the raw number of reads were not whole numbers (i.e. if the entire 50bp read mapped to an exon, we would add 50 to the total base count, which would ultimately contribute 1 to the raw read count. However, if only 25 bases of the read's alignment fell within an exon's boundaries, the total base count would be incremented by 25, which would ultimately contribute 0.5 to the raw read count).

In order to comply with the file format specification enforced by the DCC validator, our raw read counts are rounded to the closest whole number.

Exon coverage is the raw read count of an exon divided by its length.
RPKM is calculated using the formula
(number of reads (fractional) mapped to an exon x 1,000,000,000)/(NORM_TOTAL x length of an exon)
[Note: NORM_TOTAL = the total number of reads (fractional) that mapped to exons, excluding those in the mitochondrial chromosome]

If a read alignment contained a deletion or a large gap, the read did not contribute coverage inside the region spanned by the deletion/gap. Each of the paired end reads was counted separately. We excluded reads from pairs that failed Illumina's Chastity filter, as well as reads with mapping quality < 10.

.exon.quantification.txt
A tab-delimited text file containing the following fields:
- exon = Exon coordinates according to GAF (version 3.0) with the nomenclature, chr<chromosome number>:<start coordinate>-<end coordinate>:<strand>.  '.' in the <strand> indicates that there was no strand information available.  e.g. chr10:120810487-120810613:.
- raw_counts = Sum of fraction of reads (rounded off to nearest integer - restricted by the RNA-seq validator) that mapped to an exon.  Reads from pairs that did not pass Illumina’s Chastity filter or with mapping quality less than 10 were excluded from calculation.
- median_length_normalized = Average coverage over the exon i.e. the sum of the coverage depth at each base in an exon divided by the length of the exon.
- RPKM = Reads per kilobase of exon per million
